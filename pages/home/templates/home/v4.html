{% extends 'base.html' %}
{%load static%}


{%block style%}
    <link type="text/css" href="{%static 'css/index.css' %}" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{%static 'css/content--half.css'%}" />
    <script src="{%static 'js/ScrollToPlugin.min.js'%}"></script>
    <link type="text/css" href="{%static 'css/loader.css' %}" rel="stylesheet" />
{%endblock%}

{%block content%}
    

    <div class="promo-video">
        <video autoplay="" loop="" muted="" playsinline="" class="ma_video" preload="none">
            <source src="{%static 'img/video.mp4'%}" type="video/mp4">
        </video>
    </div>

    <div data-aos="fade-up" data-aos-duration="1000">
        <div class="position-relative" style="height: 100vh;">
            <div class="promo-text fadeText">
                <p class="mb-0">
                    Создаём архитектуру, которая соединяет искусство, маркетинг, экономику и&nbsp;инженерию для&nbsp;максимальной эффективности застройки
                </p>
            </div>
        </div>
    </div>


    <div data-aos="fade-up" data-aos-duration="1000" class="after-promo-index-block">
        <div>
            {%for block in vector_blocks%}
            <div class="content content--sticky content--half bg-1 content--sticky-bottom" style="background-image: linear-gradient(179.96deg, rgba(0, 0, 0, 0) 39.99%, #000000 106.58%), url({{block.image.url}});">
                <h2 class="content__title">{{block.title|safe}}</h2>
                <p class="content__text">{{block.desc|safe}}</p>
            </div>
            {%endfor%}
        </div>
    </div>
    <div class="margin-400"></div>
    <section id="numbers-block">
        <div data-aos="fade-up" data-aos-duration="1000">
            <div class="mini-container numbers-block fadeTextBlock">
                <div class="fc_ttl">   
                    <h2 >mowo&nbsp;&mdash; мультидисциплинарное бюро с&nbsp;экспертностью в&nbsp;жилой и&nbsp;коммерческой недвижимости</h2>
                </div>
                
                <div class="block-scroll">
                    <div class="d-grid numbers-items">
                         <div class="numbers-item">
                        <div class="number-num">
                            <span data-val="10">
                                10
                            </span>+
                        </div>
                        <p class="number-desc mb-0">Лет на рынке</p>
                    </div>
                    <div class="numbers-item">
                        <div class="number-num">
                            <span data-val="50">
                                50
                            </span>+
                        </div>
                        <p class="number-desc mb-0">Человек в команде</p>
                    </div>
                    <div class="numbers-item">
                        <div class="number-num">
                            <span data-val="120">
                                120
                            </span>+
                        </div>
                        <p class="number-desc mb-0">выполненных проектов</p>
                    </div>
                    <div class="numbers-item">
                        <div class="number-num">
                            <span data-val="6">
                                6
                            </span>+
                        </div>
                        <p class="number-desc mb-0">городов</p>
                    </div>
                    <div class="numbers-item">
                        <div class="number-num">
                            <span data-val="120">
                                250
                            </span>тыс.+
                        </div>
                        <p class="number-desc mb-0">построенной недвижимости</p>
                    </div>
                    </div>
                   
                </div>
            </div>
        </div>
    </section>

    <div class="margin-400"></div>
    <div data-aos="fade-up" data-aos-duration="1000">
        <div>
            {%for block in projects_blocks%}
            <div class="content content--sticky content--half bg-1 content--sticky-bottom" style="background-image: linear-gradient(179.96deg, rgba(0, 0, 0, 0) 39.99%, #000000 106.58%), url({{block.image.url}});">
                <h2 class="content__title">{{block.title|safe}}</h2>
                <p class="content__text">{{block.desc|safe}}</p>
            </div>
            {%endfor%}
        </div>
    </div>
    <div class="margin-400"></div>
    <section id="os-1">
        <div data-aos="fade-up" data-aos-duration="1000">
            <div class="mini-container">
                <div class="feedback-form">
                    <div class="feedback-form-text fc_ttl">
                        <h2>Превратим идею в&nbsp;архитектуру</h2>
                        <p>Индивидуальный подход к&nbsp;каждому проекту и&nbsp;гарантированное качество исполнения. Заполните форму, и&nbsp;мы&nbsp;подготовим персональное предложение.</p>
                    </div>
                    <div class="feedback-form-form block-scroll">
                        <form class="w-100 feedback-form mb-0" id="feedback-form">
                            {% csrf_token %}
                            <div class="d-flex gap-3 flex-md-row flex-column mb-3">
                                {{feedback.name}}
                                {{feedback.number}}
                            </div>
                            <div class="d-flex gap-3 mb-3 flex-md-row flex-column  mb-3">
                                {{feedback.email}}
                                {{feedback.company}}
                            </div>
                            {{feedback.message}}
                            <div class="d-flex justify-content-between flex-md-row flex-column  mb-3">
                                <div class="d-flex align-items-center form-check mb-md-0 mb-3">
                                    <input class="form-check-input cursor-hover" type="checkbox" id="check-modal" name="check" value="yes" checked>
                                    <label class="m-0 ms-2"> Даю согласие на обработку <a href="" style="color: rgba(255, 255, 255, 0.5);" class="cursor-hover">персональных данных</a></label>
                                </div>
                                <button class="btn d-flex align-items-center cursor-hover" type="submit">
                                    Оставить заявку
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="margin-400"></div>
    <section id="our-command">
        <div data-aos="fade-up" data-aos-duration="1000">
            <div class="mini-container">
                <div class="fc_ttl">
                    <h2>Наша команда</h2>
                    <p class="our-command-desc">Каждый проект&nbsp;&mdash; это&nbsp;результат совместного творчества архитекторов, урбанистов, дизайнеров и&nbsp;инженеров. Именно такой командный подход позволяет нам создавать по-настоящему выдающиеся решения, где&nbsp;функциональность встречается с&nbsp;искусством.</p>
                </div>
                
                    <div class=" block-scroll">
                        <div class="employee-items">
                            {%for empl in employees%}
                            <div class="employee-slide">
                                <img src="{{empl.image.url}}" alt="">
                                <p class="empl-name">{{empl.name}}</p>
                                <p class="empl-desc">{{empl.position}}</p>
                            </div>
                            {%endfor%}
                        </div>
                        
                    </div>
            </div>
        </div>
        <div class="margin-400"></div>
    </section>

    
    <div class="fadeText2 mini-container">
        <h2 class=" mobile-mini">Технологии, которые делают наш продукт точным эффективным и&nbsp;коммерчески успешным</h2>
    </div>
    <div class="margin-400"></div>
    <div data-aos="fade-up" data-aos-duration="1000">
        <div>
           {%for block in technology_blocks%}
            <div class="content content--sticky content--half bg-1 content--sticky-bottom" style="background-image: linear-gradient(179.96deg, rgba(0, 0, 0, 0) 39.99%, #000000 106.58%), url({{block.image.url}});">
                <h2 class="content__title">{{block.title|safe}}</h2>
                <p class="content__text">{{block.desc|safe}}</p>
            </div>
            {%endfor%}
        </div>
    </div>  
    <div class="margin-200"></div>
    <div class="preloader">
         <div class="wave"></div>
    </div>  
{%endblock%}

    
{%block script%}

<script src="{%static 'js/numbercount.js' %}"></script>
<script src="{%static 'js/v4/gsap.min.js'%}"></script>
<script src="{%static 'js/v4/ScrollTrigger.min.js'%}"></script>
<script src="{%static 'js/v4/imagesloaded.pkgd.min.js'%}"></script>
<script src="{%static 'js/v4/lenis.min.js'%}"></script>
{#    <script src="https://unpkg.com/lenis@1.3.8/dist/lenis.min.js"></script>#}
<script type="module" src="{%static 'js/v4/index.js'%}"></script>
<script>
    window.LOADER_WORDS = [
        {% if loader_words %}
            {% for w in loader_words %}
                "{{ w|escapejs }}"{% if not forloop.last %},{% endif %}
            {% endfor %}
        {% else %}
            "Архитектура и инженерия", "Исследование территории", "BIM", "GIS Analysis", "Algoritmic design", "AI design", "MOWO"
        {% endif %}
    ];
</script>
<script defer src="{%static 'js/loader.js'%}"></script>
<script src="{%static 'js/v4/block-scroll.js'%}"></script>

<!-- <script>
    // Initialize Lenis with smooth scrolling options
    const lenis = new Lenis({
        {#duration: 0.6,#}
        {#smoothWheel: true,#}
        {#wheelMultiplier: 0.8,#}
        {#touchMultiplier: 1.5,#}
        {#infinite: false,#}
        {#orientation: 'vertical',#}
        {#gestureOrientation: 'vertical',#}
        {#smoothTouch: false,#}
        {#lerp: 0.075#}
    });

    // Synchronize Lenis with GSAP ScrollTrigger
    lenis.on('scroll', ScrollTrigger.update);

    // Create animation frame function with time throttling
    let lastTime = 0;
    function raf(time) {
        if (time - lastTime > 16) { // ~60fps
            lenis.raf(time);
            lastTime = time;
        }
        requestAnimationFrame(raf);
    }

    // Start the animation frame loop
    requestAnimationFrame(raf);

    // Disable GSAP lag smoothing
    gsap.ticker.lagSmoothing(0);
</script> -->

<script>
    ScrollTrigger.batch(".fadeText", {
        onEnter: (batch) => gsap.to(batch, { 
            opacity: 0, 
            filter: "blur(10px)", 
            stagger: 0.1, 
            duration: 0.7,
        }),
        onLeaveBack: (batch) => gsap.to(batch, { 
            opacity: 1, 
            filter: "blur(0px)", 
            stagger: 0.1, 
            duration: 0.2,
        }),
        start: "top top+=200", 
        scrub: false,
        invalidateOnRefresh:true, 
    });

    ScrollTrigger.batch(".fadeText2", {
        onEnter: (batch) => gsap.to(batch, { 
            opacity: 0, 
            filter: "blur(10px)", 
            stagger: 0.1, 
            duration: 0.7,
        }),
        onLeaveBack: (batch) => gsap.to(batch, { 
            opacity: 1, 
            filter: "blur(0px)", 
            stagger: 0.1, 
            duration: 0.2,
        }),
        start: "top top+=200", 
        scrub: false,
        invalidateOnRefresh:true, 
    });
</script>

<script>
    const scrollBlock = document.querySelector('.ma_video');
    
    window.addEventListener('scroll', () => {
        const scrollPosition = window.scrollY;
        const maxScroll = document.documentElement.scrollHeight - window.innerHeight - 2000;
        const brightness = 1 - Math.min(scrollPosition / maxScroll, 1);

        scrollBlock.style = `filter: brightness(${brightness});`;
    });
</script>

{%endblock%}